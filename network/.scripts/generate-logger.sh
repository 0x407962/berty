#!/bin/sh -e

root_package=network

if [ $# -eq 0 ]
then
    echo "generate-logger.sh [./path/to/logger]"
fi

logfile=$1
pkg=$(dirname "$logfile" | tr -d '.')
pkgname=$(basename "$pkg")
if [ "$pkg" = "" ]; then
    logname="$root_package"
    pkgname="$root_package"
else
    logname="$root_package$(echo $pkg | tr / .)"
fi

echo "+ $logname: generate > $logfile"

cat > "$logfile" <<EOF
// Code generated by berty.tech/network/.scripts/generate-logger.sh

package $pkgname

import "go.uber.org/zap"

func logger() *zap.Logger {
    return zap.L().Named("$logname")
}

EOF

goimports -w "$logfile"
